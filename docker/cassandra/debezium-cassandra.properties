# Debezium Cassandra CDC Agent Configuration
# Standalone agent configuration for Cassandra 4.x
# Based on: https://debezium.io/documentation/reference/stable/connectors/cassandra.html

# ============================================================================
# Connector Class
# ============================================================================
connector.class=io.debezium.connector.cassandra.Cassandra4Connector

# ============================================================================
# Node Identity
# ============================================================================
cassandra.node.id=cdc-cassandra-node-1

# ============================================================================
# Cassandra Connection Settings
# ============================================================================
cassandra.hosts=localhost
cassandra.port=9042
# Note: Do not use cassandra.config - causes YAML parsing errors with time formats like "4h"
# The Debezium agent will use the driver config file instead
cassandra.driver.config.file=/opt/debezium/conf/cassandra-driver.conf

# ============================================================================
# CDC Commit Log Settings
# ============================================================================
commit.log.relocation.dir=/var/lib/cassandra/cdc_raw
commit.log.real.time.processing.enabled=true
commit.marked.complete.poll.interval.ms=1000

# ============================================================================
# Topic Naming (must match project expectations)
# ============================================================================
# This will create topics like: cdc-events.warehouse.users
topic.prefix=cdc-events

# ============================================================================
# Snapshot Settings
# ============================================================================
snapshot.mode=initial
snapshot.consistency=ONE

# ============================================================================
# Table Filtering
# ============================================================================
table.include.list=warehouse.users,warehouse.orders,warehouse.sessions

# ============================================================================
# Kafka Producer Settings
# ============================================================================
kafka.producer.bootstrap.servers=kafka:9092
kafka.producer.key.serializer=org.apache.kafka.common.serialization.StringSerializer
kafka.producer.value.serializer=org.apache.kafka.common.serialization.StringSerializer
kafka.producer.acks=1
kafka.producer.retries=3

# ============================================================================
# Offset Storage
# ============================================================================
offset.backing.store.dir=/var/lib/cassandra/cdc_offsets
offset.flush.interval.ms=60000

# ============================================================================
# Schema Change Handling
# ============================================================================
schema.change.enabled=true

# ============================================================================
# Error Handling
# ============================================================================
errors.max.retries=10
errors.retry.delay.ms=3000

# ============================================================================
# Performance Tuning
# ============================================================================
max.batch.size=2048
max.queue.size=8192
poll.interval.ms=1000

# ============================================================================
# HTTP Monitoring Port (for health checks)
# ============================================================================
http.port=8000
